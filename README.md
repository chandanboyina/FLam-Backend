# ⚙️ QueueCTL — Python-based Job Queue Management System

QueueCTL is a lightweight, reliable **CLI-driven distributed job queue system** built in Python.  
It supports **asynchronous job execution**, **persistent storage**, **multiple worker management**, **retry & backoff**, **dead letter queues (DLQ)**, **configurable settings**, and an optional **web dashboard for live monitoring**.

---

## Features Overview

| Category | Description |
|-----------|--------------|
| **Core Functionality** | Job enqueueing, execution, state tracking |
| **Persistence** | SQLite-backed durable storage (survives restarts) |
| **Workers** | Multiple worker processes with job locking |
| **Retry & Backoff** | Automatic retry with exponential delay |
| **Dead Letter Queue** | Failed jobs moved to DLQ after `max_retries` |
| **Configuration Management** | CLI-based config editing (`max_retries`, backoff) |
| **Metrics** | Average duration, job counts per state |
| **Web Dashboard** | Minimal monitoring UI (Flask-based) |
| **Output Logging** | Captures job stdout/stderr for review |
| **Timeout Handling** | Jobs automatically killed after `timeout_sec` |
| **Priority Queues** | Jobs processed based on priority value |
| **Scheduled Jobs** | Jobs delayed until specific `run_at` timestamps |

---

## Architecture Overview

###  **System Components**

QUEUECTL/
│
├── .venv/                        # Python virtual environment (dependencies isolated)
├── logs/                         # Application and worker log files
│
├── queuectl/
│   ├── __pycache__/              # Compiled Python bytecode
│   ├── templates/                # HTML templates for Flask dashboard
│   ├── __init__.py               # Package initializer
│   ├── cli.py                    # Command-line interface for job control
│   ├── config.py                 # Configuration and environment management
│   ├── dashboard.py              # Flask-based web dashboard for job monitoring
│   ├── db.py                     # SQLite persistence layer for job storage
│   ├── models.py                 # ORM-like model definitions for queue entities
│   ├── utils.py                  # Utility helpers, logging, and time functions
│   ├── worker.py                 # Core worker logic for job execution
│   └── queue.db                  # Auto-generated SQLite database file
│
├── queuectl.egg-info/            # Package metadata (auto-generated by setuptools)
│
├── tests/                        # Unit and smoke tests
│   └── smoke.sh                  # Basic smoke test script
│
├── venv/                         # Optional additional virtual environment
│
├── LICENSE                       # License information
├── pyproject.toml                # Project configuration (build system, dependencies)
├── README.md                     # Project documentation (this file)
├── smoke.db                      # Database created during smoke testing
└── queue.db                      # Root-level database instance (if used globally)


---

## **Job Lifecycle**

| **State** | **Description** |
|------------|-----------------|
| `pending` | Waiting to be picked up by a worker |
| `processing` | Currently being executed |
| `completed` | Successfully executed |
| `failed` | Failed, but retryable |
| `dead` | Permanently failed (moved to DLQ) |

---

## Setup Instructions

### Clone Repository
```bash
git clone https://github.com/chandanboyina/FLam-Backend.git
```

```bash
cd queuectl
```

## **Create Virtual Environment**

```bash
python -m venv venv
venv\Scripts\activate   # (Windows)
# or
source venv/bin/activate  # (Linux/Mac)
```

## **Install Dependencies**

```bash
pip install -e .
```

## **Initialize Database**

```bash
python -m queuectl.db
```
## **Usage Example**

### **Enqueue Jobs**

Adds jobs to the Queue

```bash
queuectl enqueue "{\"id\":\"job1\",\"command\":\"cmd /c echo Hello from QueueCTL\"}"
queuectl enqueue "{\"id\":\"job2\",\"command\":\"cmd /c exit 1\"}"
queuectl enqueue "{\"id\":\"delayed\",\"command\":\"cmd /c echo Delayed Job\",\"run_at\":\"2025-11-08T10:00:00Z\"}"
queuectl enqueue "{\"id\":\"timeout_job\",\"command\":\"cmd /c timeout 70\",\"timeout_sec\":5}"
```

### **Start Workers**

```bash
queuectl worker start --count 2

```

Starts 2 workers that process jobs concurrently

### **Check Status**

```bash
queuectl status

```
 
It prints a table of job Lifecycle Status

#### Example Output

┏━━━━━━━━━━━━━━━━━━┳━━━━━━━┓
┃ State            ┃ Count ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━┩
│ pending          │     1 │
│ processing       │     0 │
│ completed        │     3 │
│ failed           │     0 │
│ dead             │     1 │
│ dlq              │     1 │
│ avg_duration_sec │  0.04 │
└──────────────────┴───────┘









